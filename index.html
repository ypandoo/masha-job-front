<!DOCTYPE>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0"/>
<meta name="screen-orientation" content="portrait">
<meta name="x5-orientation" content="portrait">

<title>玛莎拉蒂招聘</title>
<!-- <script src="https://cdn.bootcss.com/video.js/7.0.3/video.js"></script>
<link href="https://cdn.bootcss.com/video.js/7.0.3/video-js.css" rel="stylesheet"> -->

<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="https://cdn.bootcss.com/Swiper/4.3.0/css/swiper.css" rel="stylesheet">
<script src="https://cdn.bootcss.com/Swiper/4.3.0/js/swiper.js"></script>

<script src="https://cdn.bootcss.com/vue/2.5.16/vue.min.js"></script>
<script src="https://cdn.bootcss.com/vue-resource/1.5.1/vue-resource.min.js"></script>

<script src="https://cdn.bootcss.com/element-ui/2.4.0/index.js"></script>
<link href="https://cdn.bootcss.com/element-ui/2.4.0/theme-chalk/index.css" rel="stylesheet">
<style>
body
{
  background-color:black
}

.el-input__inner {
  background: transparent !important;
  color: white !important;
}

.video-js .vjs-big-play-button {
    top: 40% !important;
    left: 50% !important;
    margin-left: -1.5em !important;
}

.swiper-pagination-bullet {
    width: 10px;
    height: 10px;
    display: inline-block;
    border-radius: 100%;
    background: #fff;
    opacity: 0.6;
}

.swiper-pagination-bullet-active {
    opacity: 1;
    background: #007aff;
}
</style>
</head>

<body style="width: 100%; padding: 0; margin: 0;">

  <div id="vueapp">
  <img src="http://p8jw7nhiw.bkt.clouddn.com/1.jpg" alt="" width="100%">

  <div style="width: 100%; margin-top:-1px; position: relative;">
    <img src="http://p8jw7nhiw.bkt.clouddn.com/2.jpg" alt="" width="100%">

    <video id="my-video" autoplay="true" controls="controls" preload="auto" style="position: absolute;
    top: 12%;
    height: 130px;
    width: 200px;
    left: 50%; background-color: black;
    margin-left: -100px;
    z-index: 1;">
            <source src="http://p8jw7nhiw.bkt.clouddn.com/Awake%20Your%20Soul%20-%20final.mp4" type='video/mp4'>
        </video>

    <!-- <video id="my-player" class="video-js" style="     position: absolute;
    top: 10px;
    height: 130px;
    width: 200px;
    left: 50%; background-color: transparent;
    margin-left: -100px;">
      <source src="http://p8jw7nhiw.bkt.clouddn.com/Awake%20Your%20Soul%20-%20final.mp4" type="video/mp4"> -->
    </video>
  </div>

  <div style="width: 100%; margin-top:-1px">
    <img src="http://p8jw7nhiw.bkt.clouddn.com/3.jpg" alt="" width="100%">
  </div>

  <div style="width: 100%; margin-top:-1px; position: relative;">
    <img src="http://p8jw7nhiw.bkt.clouddn.com/4.jpg" alt="" width="100%">

    <div @click="playAudio()" style="position: absolute;
    top: 10px;
    height: 120px;
    width: 35%;
    right: 14%;">
      <i class="fa fa-play-circle-o" aria-hidden="true" v-if="playaudio" style="    font-size: 60px;
      color: rgba(255, 255, 255, 0.5);
      margin: 35px;"></i>
      <i class="fa fa-pause-circle" aria-hidden="true"  v-if="!playaudio"  style="    font-size: 60px;
      color: rgba(255, 255, 255, 0.5);
      margin: 35px;"></i>
    </div>
  </div>

  <img src="http://p8jw7nhiw.bkt.clouddn.com/5.jpg" alt="" width="100%">

  <div style="width: 100%; background-image: url(http://p8jw7nhiw.bkt.clouddn.com/6.jpg); background-size: 100% 100%; height: 400px; overflow: hidden; height: 200px;">
    <div class="swiper-container" style="padding-top: 20px; text-align: center">
      <div class="swiper-wrapper">
          <div class="swiper-slide"><img src="http://p8jw7nhiw.bkt.clouddn.com/slider1.jpg" alt="" width="80%"></div>
          <div class="swiper-slide"><img src="http://p8jw7nhiw.bkt.clouddn.com/slider1.jpg" alt="" width="80%"></div>
          <div class="swiper-slide"><img src="http://p8jw7nhiw.bkt.clouddn.com/slider1.jpg" alt="" width="80%"></div>
      </div>
      <!-- 如果需要分页器 -->
      <div class="swiper-pagination" style="  bottom: 50px;"></div>
    </div>
  </div>

  <div style="width: 100%; background-image: url(http://p8jw7nhiw.bkt.clouddn.com/6.jpg); background-size: 100% 100%; min-height: 300px" >
    <el-row>
      <el-col :span="12" style="padding: 10px 20px">
        <el-select v-model="currentArea"  @change="getCompany()" placeholder="请选择区域">
          <el-option
            v-for="item in areas"
            :key="item._id"
            :label="item.title"
            :value="item._id">
          </el-option>
        </el-select>
      </el-col>

      <el-col :span="12" style="padding: 10px 20px">
        <el-select v-model="currentPosition"  @change="search()" placeholder="请选择职位" style="background: transparent">
          <el-option
            v-for="item in positions"
            :key="item._id"
            :label="item.title"
            :value="item._id">
          </el-option>
        </el-select>
      </el-col>
    </el-row>

      <el-row>
      <el-col :span="24" style="padding: 10px 20px">
        <el-select v-model="currentCompany"  @change="search()" placeholder="请选择经销商" style="background: transparent; width: 100%;">
          <el-option
            v-for="item in companies"
            :key="item._id"
            :label="item.title"
            :value="item._id">
          </el-option>
        </el-select>
      </el-col>
    </el-row>

    <el-row style="    padding: 10px 0;
    color: white;
    margin: 22px;
    font-size: 14px;
    border-bottom: 1px solid white;
    text-align: center;">
      <el-col :span="6">职位</el-col>
      <el-col :span="12">公司</el-col>
      <el-col :span="6">发布日期</el-col>
    </el-row>

    <el-row v-for="item in jobs" style="    padding: 10px 0;
    color: white;
    margin: 0 22px;
    font-size: 14px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    text-align: center;"     element-loading-text="拼命加载中"
    element-loading-spinner="el-icon-loading">
        <el-col :span="6">{{item.position.title}}</el-col>
        <el-col :span="12">{{item.company.title}}</el-col>
        <el-col :span="6">{{item.publish_date | parseTime('{m}-{d}')}}</el-col>
    </el-row>

    <div style="color: #a8a8a8;
    text-align: right;
    padding-right: 25px;
    font-size: 10px;     margin: 10px 0 50px 0;">
      {{'共为您检索到'+count+'条职位信息'}}
    </div>


  </div>
  </div>



<script type="text/javascript">


              window.serviceUrl = "http://www.pyonex.cc:5002"

              window.vm = new Vue({
                el: "#vueapp",
                data: {
                  positions: [],
                  companies: [],
                  areas: [],
                  jobs:[],
                  currentCompany: {},
                  currentPosition: {},
                  currentArea : {},
                  count: 0,
                  playaudio: true,
                },
                filters: {

                    parseTime: function(time, cFormat) {
                        if (arguments.length === 0) {
                          return null
                        }
                        const format = cFormat || '{y}-{m}-{d} {h}:{i}:{s}'
                        let date
                        if (typeof time === 'object') {
                          date = time
                        } else {
                          if (('' + time).length === 10) time = parseInt(time) * 1000
                          date = new Date(time)
                        }
                        const formatObj = {
                          y: date.getFullYear(),
                          m: date.getMonth() + 1,
                          d: date.getDate(),
                          h: date.getHours(),
                          i: date.getMinutes(),
                          s: date.getSeconds(),
                          a: date.getDay()
                        }
                        const time_str = format.replace(/{(y|m|d|h|i|s|a)+}/g, (result, key) => {
                          let value = formatObj[key]
                          if (key === 'a') return ['一', '二', '三', '四', '五', '六', '日'][value - 1]
                          if (result.length > 0 && value < 10) {
                            value = '0' + value
                          }
                          return value || 0
                        })
                        return time_str
                  },
                },
                methods: {
                  playAudio:function(){
                      
                      if (window.audio.paused) {
                          window.audio.play();
                          this.playaudio = false
                      } else {
                          window.audio.pause();
                          this.playaudio = true
                      }

                      //this.playaudio = !this.playaudio
                    },

                    getArea: function () {
                        var self = this;

                        //banner
                        Vue.http.post(window.serviceUrl + '/area/list', {})
                            .then(function (res) {
                                console.log(res);
                                if (res.body.error_code == 0) {
                                    self.areas = res.body.items
                                    self.currentArea = self.areas[0]._id
                                    self.getCompany()
                                } else {
                                  alert('获取地区失败!')
                                  console.log('query getArea failed!');
                                }
                            }, function (res) {
                                alert('获取地区失败!')
                                console.log('query getArea failed!');
                            });
                    },

                    getCompany: function () {
                        var self = this;

                        //banner
                        Vue.http.post(window.serviceUrl + '/company/list', {area: self.currentArea})
                            .then(function (res) {
                                console.log(res);
                                if (res.body.error_code == 0) {
                                    self.companies = res.body.items
                                    if(self.companies.length>0){
                                      self.currentCompany = self.companies[0]._id
                                      self.getPosition()
                                    }else{
                                      self.currentCompany = ""
                                      self.jobs = []
                                    }
                                } else {
                                  alert('获取经销商失败!')
                                  console.log('query getArea failed!');
                                }
                            }, function (res) {
                                alert('获取经销商失败!')
                                console.log('query getArea failed!');
                            });
                    },

                    getPosition: function () {
                        var self = this;

                        //banner
                        Vue.http.post(window.serviceUrl + '/position/list', {})
                            .then(function (res) {
                                console.log(res);
                                if (res.body.error_code == 0) {
                                    self.positions = res.body.items
                                    if(self.positions.length>0){
                                      self.currentPosition = self.positions[0]._id
                                      self.search()
                                    }else{
                                      self.currentPosition = ""
                                      self.jobs = []
                                    }
                                } else {
                                  alert('获取职位失败!')
                                  console.log('query getArea failed!');
                                }
                            }, function (res) {
                                alert('获取职位失败!')
                                console.log('query getArea failed!');
                            });
                    },

                    search: function () {
                        var self = this;

                        //banner
                        Vue.http.post(window.serviceUrl + '/job/list', {area: self.currentArea, position: self.currentPosition, company: self.currentCompany})
                            .then(function (res) {
                                console.log(res);
                                if (res.body.error_code == 0) {
                                    self.jobs = res.body.items
                                    self.count = res.body.items.length
                                } else {
                                  self.count = 0
                                  alert('获取职位失败!')
                                  console.log('query getArea failed!');
                                }
                            }, function (res) {
                                alert('获取职位失败!')
                                console.log('query getArea failed!');
                            });
                    },

                },
                mounted: function() {

                      var url = "http://p8jw7nhiw.bkt.clouddn.com/%20Maserati_HQ.mp3" ;
                      window.audio = document.createElement("audio");
                      window.source = document.createElement("source");
                      window.audio.id = "audio" ;
                      window.source.type = "audio/mpeg" ;
                      window.source.src = url ;
                      window.audio.appendChild(window.source);

                      window.mySwiper = new Swiper ('.swiper-container', {
                        autoplay: true,
                        // // 如果需要分页器
                        pagination: {
                          el: '.swiper-pagination',
                        },
                      })
                      
                      this.getArea()
                }
              });
</script>



</body>
</html>